

# `event_info.json`


## Vulcan faults mapping

The current entries in the `event_info.json` correspond to the following errors listed in the [Vulcan Faults](https://docs.google.com/spreadsheets/d/1OzXlCVPVFHe_CxohOV1J7cU6p_GAZEHJZyknDEsTUGU/edit?skip_itp2_check=true#gid=1914097812) spreadsheet:

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Device</th>
<th scope="col" class="org-right">Index</th>
<th scope="col" class="org-left">SR #</th>
</tr>
</thead>

<tbody>
<tr>
<td class="org-left">GPU</td>
<td class="org-right">0</td>
<td class="org-left">`GPU_1`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">1</td>
<td class="org-left">`GPU_6`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">2</td>
<td class="org-left">`GPU_7`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">3</td>
<td class="org-left">`GPU_8`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">4</td>
<td class="org-left">`GPU_14`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">5</td>
<td class="org-left">`GPU_3`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">6</td>
<td class="org-left">`ERoT_5`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">7</td>
<td class="org-left">`ERoT_10`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">8</td>
<td class="org-left">`ERoT_20`</td>
</tr>


<tr>
<td class="org-left">GPU</td>
<td class="org-right">9</td>
<td class="org-left">`ERoT_29`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">0</td>
<td class="org-left">`NVSwitch_2`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">1</td>
<td class="org-left">`NVSwitch_3`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">2</td>
<td class="org-left">`NVSwitch_4`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">3</td>
<td class="org-left">`NVSwitch_7`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">4</td>
<td class="org-left">`NVSwitch_8`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">5</td>
<td class="org-left">`NVSwitch_9`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">6</td>
<td class="org-left">`VR_7`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">7</td>
<td class="org-left">`ERoT_6`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">8</td>
<td class="org-left">`ERoT_11`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">9</td>
<td class="org-left">`ERoT_21`</td>
</tr>


<tr>
<td class="org-left">NVSwitch</td>
<td class="org-right">10</td>
<td class="org-left">`ERoT_30`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">0</td>
<td class="org-left">`ERoT_40`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">1</td>
<td class="org-left">`VR_9`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">2</td>
<td class="org-left">`Thermal_6`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">3</td>
<td class="org-left">`ERoT_7`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">4</td>
<td class="org-left">`ERoT_12`</td>
</tr>


<tr>
<td class="org-left">PCIeSwitch0</td>
<td class="org-right">5</td>
<td class="org-left">`ERoT_31`</td>
</tr>


<tr>
<td class="org-left">Retimer</td>
<td class="org-right">0</td>
<td class="org-left">`VR_3`</td>
</tr>


<tr>
<td class="org-left">Retimer</td>
<td class="org-right">1</td>
<td class="org-left">`VR_3`</td>
</tr>


<tr>
<td class="org-left">Retimer</td>
<td class="org-right">2</td>
<td class="org-left">`Retimer_4`</td>
</tr>


<tr>
<td class="org-left">HSC</td>
<td class="org-right">0</td>
<td class="org-left">`VR_10`</td>
</tr>


<tr>
<td class="org-left">InletSensor</td>
<td class="org-right">0</td>
<td class="org-left">`FPGA_25`</td>
</tr>


<tr>
<td class="org-left">Baseboard</td>
<td class="org-right">0</td>
<td class="org-left">`Thermal_10`</td>
</tr>
</tbody>
</table>

where `SR #` is the name of the event identifying column in the "Summary" sheet of the "Vulcan Faults" document given above, and ("Device", "Index") pair identifies the entry in `event_info.json` file.


## `"message_args"`


### Description

The `"message_args"` object with `"patterns"` and `"parameters"` properties describe the methods of obtaining values for the parameters listed in the "MessageArgs" column of the [Vulcan Faults](https://docs.google.com/spreadsheets/d/1OzXlCVPVFHe_CxohOV1J7cU6p_GAZEHJZyknDEsTUGU/edit?skip_itp2_check=true#gid=1914097812) spreadsheet. For example, `.GPU.[0]` entry ("OverTemp") is associated with `MessageArgs` value

    ["{GPUId} Temperature", "{UpperFatal Threshold}"]

This translates to the `"redfish"` entry like

    "redfish": {
      "message_id": "ResourceEvent.1.0.ResourceErrorThresholdExceeded",
      "message_args" : {
        "patterns": [
          "{GPUId} Temperature",
          "{UpperFatal Threshold}"
        ],
        "parameters": [
          {
            "type": "DIRECT",
            "field": "CurrentDeviceName"
          },
          {
            "type": "DBUS",
            "interface": "…",
            "object": "…",
            "property": "…"
          }
        ]
      }
    }

-   **`"message_id"`:** Represents a pointer to a redfish message format string to which `"message_args"` elements are inserted. Typically used value:
    
        The resource property %1 has detected errors of type %2.
    
    See the "Message" column in the [Vulcan Faults](https://docs.google.com/spreadsheets/d/1OzXlCVPVFHe_CxohOV1J7cU6p_GAZEHJZyknDEsTUGU/edit?skip_itp2_check=true#gid=1914097812) spreadsheet.
-   **`"patterns"`:** The actual string values inserted in the message upon the occurrence of an event. They can contain placeholders in the form `"{Some Name}"` which are substituted with values dynamically obtained during an event, as described by the `"parameters"` attribute (see below). The string between the curly brackets is irrelevant to the substitution logic (can be used for documentation purposes). The entries can contain no placeholders, like `"Secure Boot Failure"` , or multiple placeholders, like `"xxx {param1} yyy {param2}"`.
-   **`"parameters"`:** Describe the means of obtaining the values for placeholders in the `"patterns"` attribute. The number of elements must be equal to the total number of placeholders in `"patterns"` array. The values are substituted in the same order.
    
    Every object in the `"parameters"` array is an accessor with the same syntax and semantics as those used for `"accessor"` and `"event_trigger"` entries. See [Accessor format](#orgfc57f5d). which gives the following list of accessor types:


### Example 1: XID related log entry ("DRAM Contained ECC Error")

    {
      "event": "DRAM Contained ECC Error",
      "device_type": "GPUDRAM[0-7]",
      "event_trigger": {
        "type": "DBUS",
        "object": "/xyz/openbmc_project/inventory/system/chassis/GPU[0-7]",
        "interface": "xyz.openbmc_project.com.nvidia.Events.PendingRegister",
        "property": "EventsPendingRegister",
        "check": {"bitmask": "4"}
      },
      "accessor": {
        "type": "DeviceCoreAPI",
        "property": "gpu.xid.event",
        "check": {"lookup": "94"}
      },
      "severity": "Warning",
      "resolution": "Restart the affected application.",
      "trigger_count": 0,
      "event_counter_reset": {
        "type": "",
        "metadata": ""
      },
      "redfish": {
        "message_id": "ResourceEvent.1.0.ResourceErrorsDetected",
        "message_args" : {
          "patterns" : [
            "{GPUId} Memory",
            "Contained ECC Error"
          ],
          "parameters" : [
            {
              "type" : "DIRECT",
              "field": "CurrentDeviceName"
            }
          ]
        }
      },
      "telemetries": [],
      "action": "",
      "value_as_count": true
    }


### Example 2: XID log entry

    {
      "event": "XID log",
      "device_type": "GPU[0-7]",
      "event_trigger": {
        "type": "DBUS",
        "object": "/xyz/openbmc_project/inventory/system/chassis/GPU[0-7]",
        "interface": "xyz.openbmc_project.com.nvidia.Events.PendingRegister",
        "property": "EventsPendingRegister",
        "check": {"bitmask": "4"}
      },
      "accessor": {
        "type": "DeviceCoreAPI",
        "property": "gpu.xid.event"
      },
      "severity": "Warning",
      "resolution": "Restart the affected application.",
      "trigger_count": 0,
      "event_counter_reset": {
        "type": "",
        "metadata": ""
      },
      "redfish": {
        "message_id": "ResourceEvent.1.0.ResourceErrorsDetected",
        "message_args": {
          "patterns" : [
            "{GPUId} Memory {}",
            "Contained ECC Error {}"
          ],
          "parameters" : [
            {
              "type" : "DIRECT",
              "field": "CurrentDeviceName"
            },
            {
              "type" : "DIRECT",
              "field": "CurrentDeviceName"
            },
            {
              "type" : "DIRECT",
              "field": "CurrentDeviceName"
            }
          ]
        }
      },
      "telemetries": [],
      "action": "",
      "value_as_count": true
    }


## Schema file

The schema for the full `event_info.json` file, containing formal definition of the format, is provided in the `event_info-schema.json` file.

There are many tools performing the validation of a given json file for the provided schema, for example <https://extendsclass.com/json-schema-validator.html>.


<a id="orgfc57f5d"></a>

# Accessor format

-   **Current device name accessor:** Translates to the name of the device the fault occured on, e.g. `GPU3` or `NVSwitch1`
    
        {
          "type": "DIRECT",
          "field" : "CurrentDeviceName"
        }
-   **DBUS-type accessor:** Obtain the value of the parameter from a dbus property.
    
        {
          "type": "DBUS",
          "object": "…",
          "interface": "…",
          "property": "…",
          "check": …
        }
-   **Device Core API accessor:** Obtain the value of the parameter using the device's API
    
        {
          "type": "DeviceCoreAPI",
          "property": "…",
          "check": …
        }
-   **Command line accessor:** Obtain the value of the parameter using the output of a command call
    
        {
          "type": "CMDLINE",
          "executable": "…",
          "arguments": "…",
          "check": …
        }
-   **Constant value "accessor":** Always return the `"value"` property literally
    
        {
          "type": "CONSTANT",
          "value": "…",
        }
    
    This accessor can be useful for testing and debugging purposes to mockup a return value from some other type accessor. It can also be useful in including the literal `{` or `}` characters in the final message arg without messing with the placeholder identification, eg
    
        "message_args": {
          "patterns": [
            "{}"
          ],
          "parameters": [
            {
              "type": "CONSTANT",
              "value": "{UpperCritical Threshold}"
            }
          ]
        }
    
    would become `"{UpperCritical Threshold}"`.

